"0",""
"0",""
"0","# Just plot hierarchical cluster, color-code sample by treatment, or by tank number"
"0","cluster.dendo <- as.dendrogram(cluster.most.variable$tree_row) "
"0","#plot(cluster.dendo) # bare bones dendogram"
"0","#order.dendrogram(cluster.dendo) # to find out the order of the sample labels "
"0",""
"0","# Create a dataframe ordered the same as the dendogram for annotation purposes "
"0","dendo.df <- sample.info[match(cluster.most.variable$tree_row$labels, sample.info$vial_label),c(""vial_label"", ""treatment"", ""tank"", ""temperature"", ""ph"")]"
"0","all(dendo.df$vial_label == cluster.most.variable$tree_row$labels) # Should == TRUE"
"1","[1]"
"1"," TRUE"
"1","
"
"0","# Create color coding vectors "
"0","colorCodes.treat <- c(`3_amb`= ""navyblue"", `3_low`=""royalblue1"","
"0","            `6_amb`=""darkgreen"", `6_low`=""yellow3"","
"0","            `10_amb`=""firebrick4"", `10_low`=""sienna2"")"
"0","colorCodes.tank <- colorRampPalette(brewer.pal(12, ""Paired""))(length(levels(sample.info$tank)))"
"0",""
"0","# # Color code sample names by treatment"
"0","#labels_colors(cluster.dendo) <- colorCodes.treat[as.character(dendo.df$treatment[order.dendrogram(cluster.dendo)])]"
"0","#plot(cluster.dendo, xlab=""Sample (color=treatment)"") # plot with sample names color coded by treatment "
"0",""
"0","# Plot dendogram color-code by treatment, but labels are tank number"
"0","labels(cluster.dendo) <- dendo.df$tank[order.dendrogram(cluster.dendo)]"
"0","labels_colors(cluster.dendo) <- colorCodes.treat[as.character(dendo.df$treatment[order.dendrogram(cluster.dendo)])]"
"0","plot(cluster.dendo, xlab=""Tank Number"", cex.lab=1) # plot with sample names color coded by tank"
