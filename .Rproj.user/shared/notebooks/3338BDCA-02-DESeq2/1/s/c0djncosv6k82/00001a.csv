"0","ph.amb <- sample.info[sample.info$ph==""amb"",]$vial_label"
"0",""
"0","# Generate counts matrix With DEGs among any tempreature treatment, ambient pH only"
"0","diffex.temp.counts.amb <-  "
"0","  (subset(assay(vsd.treatment), rownames(dds.DESeq.treatment) %in% "
"0","            unique(c(rownames(diffex.temp.3.6.amb),"
"0","                     rownames(diffex.temp.3.10.amb),"
"0","                     rownames(diffex.temp.6.10.amb)))) %>% "
"0","     as.data.frame())[ph.amb] %>% as.matrix()"
"0",""
"0","# Create a dataframe to annotate heatmap with treatments "
"0","dds.temp.df <- sample.info[match(colnames(diffex.temp.counts.amb), sample.info$vial_label),c(""vial_label"", ""treatment"", ""tank"", ""temperature"", ""ph"")] %>%"
"0","  remove_rownames() %>% column_to_rownames(var = ""vial_label"")"
"0",""
"0","# Make sure treatment order is correct"
"0","all(colnames(diffex.temp.counts.amb) == rownames(dds.temp.df)) #double check that samples are still in same order "
"1","[1]"
"1"," TRUE"
"1","
"
"0","# All DEGs among any temp treatment (within temperatures)"
"0","pheatmap(diffex.temp.counts.amb, cluster_rows=TRUE, cluster_cols=FALSE,"
"0","         show_rownames=FALSE, na.rm=TRUE, "
"0","         annotation_colors = list(temperature = c(""3""= ""navyblue"", ""6""=""darkgreen"",""10""=""firebrick4"")),"
"0","         scale=""row"", "
"0","         main = ""Differentially expressed genes (DEGs) among any temperature treatment\nAmbient pH only"", "
"0","         annotation_col=dds.temp.df[,""temperature"", drop=FALSE], fontsize = 8,"
"0","         cutree_rows = 2,  border_color=F)"
