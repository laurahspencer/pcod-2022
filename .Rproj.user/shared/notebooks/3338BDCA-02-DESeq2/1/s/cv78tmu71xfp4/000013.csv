"0","#pca.princomp <- prcomp(cov(assay(vsd.pH)), scale=F) #scale=F for variance-covariance matrix"
"0","pca.princomp <- prcomp(t(assay(vsd.treatment))) # using the same code that's under the hood of PlotPCA but using all genes "
"0","pca.eigenval(pca.princomp) #The Proporation of Variance = %variance "
"1","Importance of components:
"
"1","                      "
"1","         PC1"
"1","         PC2"
"1","         PC3"
"1","         PC4"
"1","        PC5"
"1","        PC6"
"1","        PC7"
"1","        PC8"
"1","        PC9"
"1","       PC10"
"1","       PC11"
"1","       PC12"
"1","       PC13"
"1","       PC14"
"1","       PC15"
"1","       PC16"
"1","       PC17"
"1","
Variance(eigenvalue)  "
"1"," 896.8365541"
"1"," 385.8660728"
"1"," 171.2762624"
"1"," 128.1763460"
"1"," 85.5133419"
"1"," 74.5650034"
"1"," 58.4440578"
"1"," 50.4533520"
"1"," 37.5024515"
"1"," 36.6723268"
"1"," 31.3563646"
"1"," 28.4514497"
"1"," 26.1460333"
"1"," 23.8419346"
"1"," 23.2389200"
"1"," 21.3288537"
"1"," 19.1909421"
"1","
Proportion of Variance"
"1","   0.3418859"
"1","   0.1470972"
"1","   0.0652928"
"1","   0.0488625"
"1","  0.0325988"
"1","  0.0284252"
"1","  0.0222796"
"1","  0.0192335"
"1","  0.0142964"
"1","  0.0139800"
"1","  0.0119535"
"1","  0.0108461"
"1","  0.0099672"
"1","  0.0090889"
"1","  0.0088590"
"1","  0.0081308"
"1","  0.0073158"
"1","
Cumulative Proportion "
"1","   0.3418859"
"1","   0.4889831"
"1","   0.5542759"
"1","   0.6031384"
"1","  0.6357372"
"1","  0.6641624"
"1","  0.6864420"
"1","  0.7056755"
"1","  0.7199720"
"1","  0.7339519"
"1","  0.7459054"
"1","  0.7567515"
"1","  0.7667187"
"1","  0.7758075"
"1","  0.7846665"
"1","  0.7927973"
"1","  0.8001132"
"1","
Broken-stick value    "
"1","   4.9013556"
"1","   3.9013556"
"1","   3.4013556"
"1","   3.0680223"
"1","  2.8180223"
"1","  2.6180223"
"1","  2.4513556"
"1","  2.3084985"
"1","  2.1834985"
"1","  2.0723874"
"1","  1.9723874"
"1","  1.8814783"
"1","  1.7981450"
"1","  1.7212219"
"1","  1.6497933"
"1","  1.5831266"
"1","  1.5206266"
"1","
"
"1","                      "
"1","       PC18"
"1","       PC19"
"1","       PC20"
"1","       PC21"
"1","       PC22"
"1","       PC23"
"1","       PC24"
"1","       PC25"
"1","       PC26"
"1","       PC27"
"1","       PC28"
"1","       PC29"
"1","       PC30"
"1","       PC31"
"1","       PC32"
"1","       PC33"
"1","       PC34"
"1","
Variance(eigenvalue)  "
"1"," 18.7626976"
"1"," 18.2062240"
"1"," 17.4115859"
"1"," 17.2312472"
"1"," 16.3062059"
"1"," 15.4076040"
"1"," 14.0485100"
"1"," 13.8787384"
"1"," 13.1519779"
"1"," 12.6857923"
"1"," 12.4943675"
"1"," 12.3331610"
"1"," 11.7159389"
"1"," 11.1808874"
"1"," 10.7429339"
"1"," 10.4864567"
"1"," 10.3620104"
"1","
Proportion of Variance"
"1","  0.0071526"
"1","  0.0069405"
"1","  0.0066375"
"1","  0.0065688"
"1","  0.0062161"
"1","  0.0058736"
"1","  0.0053555"
"1","  0.0052908"
"1","  0.0050137"
"1","  0.0048360"
"1","  0.0047630"
"1","  0.0047016"
"1","  0.0044663"
"1","  0.0042623"
"1","  0.0040953"
"1","  0.0039976"
"1","  0.0039501"
"1","
Cumulative Proportion "
"1","  0.8072658"
"1","  0.8142062"
"1","  0.8208438"
"1","  0.8274125"
"1","  0.8336287"
"1","  0.8395023"
"1","  0.8448577"
"1","  0.8501485"
"1","  0.8551622"
"1","  0.8599982"
"1","  0.8647612"
"1","  0.8694628"
"1","  0.8739290"
"1","  0.8781913"
"1","  0.8822867"
"1","  0.8862843"
"1","  0.8902344"
"1","
Broken-stick value    "
"1","  1.4618031"
"1","  1.4062476"
"1","  1.3536160"
"1","  1.3036160"
"1","  1.2559969"
"1","  1.2105424"
"1","  1.1670641"
"1","  1.1253975"
"1","  1.0853975"
"1","  1.0469359"
"1","  1.0098989"
"1","  0.9741846"
"1","  0.9397018"
"1","  0.9063685"
"1","  0.8741104"
"1","  0.8428604"
"1","  0.8125574"
"1","
"
"1","                      "
"1","       PC35"
"1","      PC36"
"1","      PC37"
"1","      PC38"
"1","      PC39"
"1","      PC40"
"1","      PC41"
"1","      PC42"
"1","      PC43"
"1","      PC44"
"1","      PC45"
"1","      PC46"
"1","      PC47"
"1","      PC48"
"1","      PC49"
"1","      PC50"
"1","      PC51"
"1","      PC52"
"1","      PC53"
"1","
Variance(eigenvalue)  "
"1"," 10.1860309"
"1"," 9.9914108"
"1"," 9.7657944"
"1"," 9.4166401"
"1"," 9.3145092"
"1"," 9.1752143"
"1"," 8.8913591"
"1"," 8.7950486"
"1"," 8.5972473"
"1"," 8.4424642"
"1"," 8.3520688"
"1"," 8.2606218"
"1"," 8.1130943"
"1"," 7.7419078"
"1"," 7.6512848"
"1"," 7.6198223"
"1"," 7.4021628"
"1"," 7.3308580"
"1"," 7.1455387"
"1","
Proportion of Variance"
"1","  0.0038830"
"1"," 0.0038089"
"1"," 0.0037228"
"1"," 0.0035897"
"1"," 0.0035508"
"1"," 0.0034977"
"1"," 0.0033895"
"1"," 0.0033528"
"1"," 0.0032774"
"1"," 0.0032184"
"1"," 0.0031839"
"1"," 0.0031491"
"1"," 0.0030928"
"1"," 0.0029513"
"1"," 0.0029168"
"1"," 0.0029048"
"1"," 0.0028218"
"1"," 0.0027946"
"1"," 0.0027240"
"1","
Cumulative Proportion "
"1","  0.8941174"
"1"," 0.8979263"
"1"," 0.9016492"
"1"," 0.9052389"
"1"," 0.9087897"
"1"," 0.9122874"
"1"," 0.9156769"
"1"," 0.9190297"
"1"," 0.9223071"
"1"," 0.9255255"
"1"," 0.9287094"
"1"," 0.9318585"
"1"," 0.9349513"
"1"," 0.9379026"
"1"," 0.9408194"
"1"," 0.9437241"
"1"," 0.9465459"
"1"," 0.9493406"
"1"," 0.9520645"
"1","
Broken-stick value    "
"1","  0.7831456"
"1"," 0.7545742"
"1"," 0.7267964"
"1"," 0.6997694"
"1"," 0.6734536"
"1"," 0.6478126"
"1"," 0.6228126"
"1"," 0.5984223"
"1"," 0.5746128"
"1"," 0.5513570"
"1"," 0.5286297"
"1"," 0.5064075"
"1"," 0.4846684"
"1"," 0.4633918"
"1"," 0.4425585"
"1"," 0.4221503"
"1"," 0.4021503"
"1"," 0.3825424"
"1"," 0.3633117"
"1","
"
"1","                      "
"1","      PC54"
"1","      PC55"
"1","      PC56"
"1","      PC57"
"1","      PC58"
"1","      PC59"
"1","      PC60"
"1","      PC61"
"1","      PC62"
"1","      PC63"
"1","      PC64"
"1","      PC65"
"1","      PC66"
"1","      PC67"
"1","      PC68"
"1","      PC69"
"1","      PC70"
"1","      PC71"
"1","      PC72"
"1","
Variance(eigenvalue)  "
"1"," 7.0538012"
"1"," 6.9133462"
"1"," 6.8746431"
"1"," 6.7539768"
"1"," 6.5138450"
"1"," 6.4573748"
"1"," 6.4141696"
"1"," 6.3273922"
"1"," 6.2871132"
"1"," 6.0996856"
"1"," 5.9397823"
"1"," 5.8915585"
"1"," 5.8146447"
"1"," 5.6765612"
"1"," 5.5878660"
"1"," 5.4120079"
"1"," 5.3764899"
"1"," 5.1833375"
"1"," 5.1327125"
"1","
Proportion of Variance"
"1"," 0.0026890"
"1"," 0.0026355"
"1"," 0.0026207"
"1"," 0.0025747"
"1"," 0.0024832"
"1"," 0.0024616"
"1"," 0.0024452"
"1"," 0.0024121"
"1"," 0.0023967"
"1"," 0.0023253"
"1"," 0.0022643"
"1"," 0.0022459"
"1"," 0.0022166"
"1"," 0.0021640"
"1"," 0.0021302"
"1"," 0.0020631"
"1"," 0.0020496"
"1"," 0.0019760"
"1"," 0.0019567"
"1","
Cumulative Proportion "
"1"," 0.9547535"
"1"," 0.9573890"
"1"," 0.9600097"
"1"," 0.9625844"
"1"," 0.9650676"
"1"," 0.9675292"
"1"," 0.9699744"
"1"," 0.9723865"
"1"," 0.9747832"
"1"," 0.9771085"
"1"," 0.9793728"
"1"," 0.9816187"
"1"," 0.9838353"
"1"," 0.9859993"
"1"," 0.9881295"
"1"," 0.9901926"
"1"," 0.9922422"
"1"," 0.9942182"
"1"," 0.9961748"
"1","
Broken-stick value    "
"1"," 0.3444438"
"1"," 0.3259252"
"1"," 0.3077434"
"1"," 0.2898863"
"1"," 0.2723424"
"1"," 0.2551010"
"1"," 0.2381519"
"1"," 0.2214852"
"1"," 0.2050918"
"1"," 0.1889627"
"1"," 0.1730897"
"1"," 0.1574647"
"1"," 0.1420801"
"1"," 0.1269286"
"1"," 0.1120032"
"1"," 0.0972973"
"1"," 0.0828046"
"1"," 0.0685189"
"1"," 0.0544344"
"1","
"
"1","                      "
"1","      PC73"
"1","      PC74"
"1","      PC75"
"1","
Variance(eigenvalue)  "
"1"," 5.0828007"
"1"," 4.9514025"
"1"," 0.0000000"
"1","
Proportion of Variance"
"1"," 0.0019376"
"1"," 0.0018875"
"1"," 0.0000000"
"1","
Cumulative Proportion "
"1"," 0.9981125"
"1"," 1.0000000"
"1"," 1.0000000"
"1","
Broken-stick value    "
"1"," 0.0405455"
"1"," 0.0268468"
"1"," 0.0133333"
"1","
"
"0","pc.percent <- pca.eigenval(pca.princomp)[2,1:5]*100"
"1","Importance of components:
"
"0","pc.percent[1:2] %>% sum()"
"1","[1]"
"1"," 48.89831"
"1","
"
"0","screeplot(pca.princomp, bstick=TRUE) #looks like PC 1-4 are significant "
