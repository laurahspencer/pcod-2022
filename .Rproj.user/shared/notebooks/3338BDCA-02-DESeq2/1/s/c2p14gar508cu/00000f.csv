"0","# Generate counts matrix With DEGs among any pH treatment"
"0","diffex.pH.counts <- subset(assay(vsd.treatment), rownames(dds.DESeq.treatment) %in% unique(c(rownames(diffex.pH.3),rownames(diffex.pH.6),rownames(diffex.pH.10))))"
"0",""
"0","# Create a dataframe to annotate heatmap with treatments "
"0","dds.pH.df <- sample.info[match(colnames(diffex.pH.counts), sample.info$vial_label),c(""vial_label"", ""treatment"", ""tank"", ""temperature"", ""ph"")] %>%"
"0","  remove_rownames() %>% column_to_rownames(var = ""vial_label"")"
"0",""
"0","# Make sure treatment order is correct"
"0","all(colnames(diffex.pH.counts) == rownames(dds.pH.df)) #double check that samples are still in same order "
"1","[1]"
"1"," TRUE"
"1","
"
"0","# All DEGs among any pH treatment (within temperatures)"
"0","pheatmap(diffex.pH.counts, cluster_rows=TRUE, cluster_cols=FALSE,"
"0","         show_rownames=FALSE, na.rm=TRUE, annotation_colors = list(treatment="
"0","             c(""3_amb""= ""navyblue"", ""3_low""=""royalblue1"",""6_amb""=""darkgreen"","
"0","               ""6_low""=""yellow3"",""10_amb""=""firebrick4"", ""10_low""=""sienna2"")),"
"0","         scale=""row"", main = ""Differentially expressed genes (DEGs) among any pH treatment"", "
"0","         annotation_col=dds.pH.df[,""treatment"", drop=FALSE], fontsize = 8,"
"0","         cutree_rows = 2,  border_color=F)"
