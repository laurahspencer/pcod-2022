"0","keep1 <- colMeans(counts.t, na.rm=TRUE) >= 10 #identify genes with mean count >= 10 across all samples (excluding NAs = 10)"
"0","keep2 <- rowSums( counts >= 30 ) >= 0.1*59 #identify genes with counts>=30 across at minimum 10% of the samples"
"0","keep <- unique(c(names(which(keep1 == T)), names(which(keep2 == T)))) # list of genes meeting one of the two above criteria"
"0","counts.ts <- counts.t[,keep]"
"0",""
"0","print(paste(""# genes before filtering:"", ncol(counts.t)))"
"1","[1]"
"1"," ""# genes before filtering: 32483"""
"1","
"
"0","print(paste(""# genes remaining after pre-filtering:"", ncol(counts.ts)))"
"1","[1]"
"1"," ""# genes remaining after pre-filtering: 20975"""
"1","
"
"0","print(paste(""# of genes dropped:"", ncol(counts.t) - ncol(counts.ts), sep="" ""))"
"1","[1]"
"1"," ""# of genes dropped: 11508"""
"1","
"
"0","print(paste(""% of fragments remaining after pre-filtering: "", signif(100*sum(counts.ts)/sum(counts.t), digits = 5), ""%"", sep=""""))"
"1","[1]"
"1"," ""% of fragments remaining after pre-filtering: 99.973%"""
"1","
"
"0","print(paste(""Number of fragments dropped: "", signif(sum(counts.t)-sum(counts.ts), digits = 5)))"
"1","[1]"
"1"," ""Number of fragments dropped:  872060"""
"1","
"
"0","print(paste(""% of fragments dropped: "", signif(100*(sum(counts.t)-sum(counts.ts))/sum(counts.t), digits = 5), ""%"", sep=""""))"
"1","[1]"
"1"," ""% of fragments dropped: 0.026566%"""
"1","
"
"0","print(paste(""Number of fragments remaining: "", signif(sum(counts.ts), digits = 5)))"
"1","[1]"
"1"," ""Number of fragments remaining:  3281700000"""
"1","
"
